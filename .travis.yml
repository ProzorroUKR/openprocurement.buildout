language: python
sudo: required
group: deprecated-2017Q4
before_script:
- sudo apt-get -qq update
- sudo apt-get install -y libsodium-dev
python:
- '2.7'
services:
- couchdb
env:
  global:
  - TZ=Europe/Kiev
  - PYTEST_AGRS="--ignore src/openprocurement.archivarius.core/openprocurement/archivarius/core/tests/bridge.py --maxfail=1"
  - BOTO_CONFIG=/dev/null
  matrix:
  - MODULE=openprocurement.api
  - MODULE=openprocurement.api SANDBOX_MODE=True
  - MODULE=openprocurement.archivarius.plans
  - MODULE=openprocurement.archivarius.plans SANDBOX_MODE=True
  - MODULE=openprocurement.archivarius.contracts
  - MODULE=openprocurement.archivarius.contracts SANDBOX_MODE=True
  - MODULE=openprocurement.archivarius.tenders
  - MODULE=openprocurement.archivarius.tenders SANDBOX_MODE=True
  - MODULE=openprocurement.archivarius.core
  - MODULE=openprocurement.archivarius.core SANDBOX_MODE=True
  - MODULE=openprocurement.concord
  - MODULE=openprocurement.concord SANDBOX_MODE=True
cache:
  directories:
  - eggs
before_install:
- sh bootstrap.sh
install:
- . ./travis_branch.sh
- bin/buildout -N -c buildout.cfg.example remotes:branch=$BRANCH
script:
- bin/py.test src/$MODULE/ $PYTEST_AGRS
